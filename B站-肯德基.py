import requests
import re
import pandas
from bs4 import BeautifulSoup
from urllib import parse
import time
import random
import json
'''
key=['肯德基 ','麦当劳','德克士']
pages=[50,50,14]
result={}
def get_inf(k,page):
    lists=[]
    print('================================%d==============================' % page)
    time.sleep(random.randint(1, 3))
    headers = {
        'Cookie': 'LIVE_BUVID=AUTO6915375856445563; stardustvideo=1; buvid3=EEB30FF5-70B4-4E16-B15A-94FE3F7AF07F163007infoc; rpdid=kmpsximoqmdoskmsqsxqw; finger=edc6ecda; CURRENT_FNVAL=16; fts=1540866975; UM_distinctid=166c2db295180-082aa06c2afa6d-47e1039-100200-166c2db2952110; _uuid=CFC2C300-5CD2-8037-5C03-9E030429816F73117infoc; sid=i0uy9cfw; DedeUserID=335241854; DedeUserID__ckMd5=eb2448443ce99860; SESSDATA=d82f388a%2C1544059883%2Cc7e43a79; bili_jct=40c8aae11d6e66329562648f092694a4; _dfcaptcha=3ce3b12ecc0413f25b43dbabd4553944',
        'Host': 'search.bilibili.com',
        'Referer': 'https://www.bilibili.com/',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'
    }
    url = 'https://search.bilibili.com/all?keyword=' + parse.quote(k) + '&page={}'.format(str(page))
    try:
        html = requests.get(url, headers=headers).text
        soup = BeautifulSoup(html, 'lxml')
        hrefs = soup.find('ul', class_='video-contain clearfix').find_all('li', class_='video matrix')
        for href in hrefs:
            href =href.find('div', class_='headline clearfix').find('span', class_='type avid').text
            lists.append(href)
        return lists
    except Exception as e:
        print(e)
        get_inf(k,page)

for i in range(len(key)):
    k=key[i]
    url_lists = []
    for page in range(1,pages[i]+1):
        u=get_inf(k,page)
        print(u)
        url_lists=url_lists+u
    result[k] = url_lists
    print(url_lists)
    print(result)
'''
#抓取评论
def get_comment(url,k,headers):
    headers=headers
    df=pandas.DataFrame()
    html=requests.get(url,headers=headers).text
    html=(html.split('(',1))[1][:-1]
    html=json.loads(html)
    reps=html['data']['replies']
    #print(reps)
    try:
        for rep in reps:
            inf = {}
            if not k in rep['content']['message']:
                continue
            else:
                inf['评论'] = rep['content']['message']
                inf['time'] = rep['ctime']
                inf['floor'] = rep['floor']
                inf['点赞'] = rep['like']
                inf['性别'] = rep['member']['sex']
                inf['name'] = rep['member']['uname']
                inf['等级'] = rep['member']['level_info']['current_level']
                inf['回复'] = rep['rcount']
                df = df.append(inf, ignore_index=True)
            # print(inf)
        df.to_csv(k + '1.csv', index=False, mode='a', header=False,columns=['评论', 'time', 'floor', '点赞', '性别', 'name', '等级', '回复'], encoding='utf-8')
    except KeyError:
        print('这一面没有相关评论')
#['av15676766',]
if __name__=='__main__':
    key = ['肯德基', '麦当劳', '德克士']
    key = [  '麦当劳']
    result={'肯德基': [ 'av22500679', 'av30879867', 'av33268662', 'av30931816', 'av34954536', 'av25809916', 'av15676766', 'av33655223', 'av17053712', 'av3480346', 'av10220153', 'av34163567', 'av28521491', 'av35068253', 'av34334597', 'av10236419', 'av35066439', 'av24411179', 'av35119511', 'av32842955', 'av29186401', 'av27548494', 'av13813271', 'av23937599', 'av12747151', 'av3580126', 'av28359899', 'av17532309', 'av31447596', 'av29420806', 'av33571033', 'av15731036', 'av26034061', 'av29254802', 'av33507961', 'av30757471', 'av17570898', 'av24395914', 'av22925927', 'av34796872', 'av29274349', 'av34207940', 'av35237541', 'av31311220', 'av25873827', 'av18357873', 'av25320282', 'av33892295', 'av11437228', 'av15509311', 'av14691910', 'av17653691', 'av28120859', 'av5106513', 'av32826995', 'av31029002', 'av34076670', 'av5747690', 'av33223809', 'av35123445', 'av34035098', 'av32514137', 'av34044516', 'av34198240', 'av32934333', 'av32447944', 'av18715105', 'av35362352', 'av23547945', 'av34187655', 'av33739490', 'av14381514', 'av34431209', 'av30805464', 'av11963477', 'av30321719', 'av33483768', 'av33817125', 'av35248494', 'av34914896', 'av35166264', 'av29217820', 'av10285910', 'av25201965', 'av20259831', 'av11989952', 'av26211073', 'av34096066', 'av13580471', 'av26513207', 'av35107942', 'av33399508', 'av27878763', 'av31826226', 'av34617543', 'av34254339', 'av33030199', 'av14575278', 'av34720832', 'av30585545', 'av35121804', 'av28197647', 'av35269130', 'av25851622', 'av35105852', 'av33621790', 'av30670067', 'av34168578', 'av17771020', 'av31469740', 'av27871854', 'av34559134', 'av34273954', 'av34220641', 'av29040651', 'av7679353', 'av32226830', 'av33489601', 'av34851148', 'av23858636', 'av20875834', 'av24308792', 'av33116646', 'av28812737', 'av13789454', 'av34488740', 'av21520001', 'av33442780', 'av25861553', 'av35043955', 'av33180891', 'av18099162', 'av23258447', 'av35293990', 'av7450399', 'av24238931', 'av34395926', 'av34089592', 'av33283504', 'av31863742', 'av31591870', 'av33091039', 'av32728027', 'av20138113', 'av31452953', 'av33494935', 'av34169167', 'av21331344', 'av12904895', 'av34987765', 'av25161528', 'av34256985', 'av32124052', 'av17782940', 'av31713092', 'av26190283', 'av28524598', 'av26435313', 'av16597802', 'av34171532', 'av30742611', 'av6635249', 'av34381984', 'av34204574', 'av31272251', 'av34681358', 'av28006088', 'av24762259', 'av33280012', 'av21882067', 'av29231378', 'av33764672', 'av31249710', 'av22281074', 'av30295863', 'av31207910', 'av28252772', 'av25062066', 'av18961738', 'av28360216', 'av17930853', 'av28879752', 'av22025785', 'av32008451', 'av17621577', 'av26544973', 'av21403396', 'av23198349', 'av30957088', 'av28400056', 'av25182073', 'av33029477', 'av27064704', 'av31997956', 'av26169580', 'av14590414', 'av26495479', 'av28947848', 'av25952085', 'av32684224', 'av16702818', 'av31038535', 'av15872308', 'av34208295', 'av24330728', 'av28035187', 'av26624498', 'av28773227', 'av21681171', 'av33717293', 'av28848480', 'av24909410', 'av10325111', 'av28008770', 'av29681499', 'av23645728', 'av29608190', 'av26135307', 'av32631772', 'av34474267', 'av14455511', 'av26492477', 'av26693944', 'av16823216', 'av30339730', 'av13803097', 'av24692282', 'av34566605', 'av11718466', 'av23623618', 'av19213509', 'av21464938', 'av17533001', 'av31685654', 'av18196938', 'av26830232', 'av31186882', 'av23909463', 'av23725364', 'av31002691', 'av28359048', 'av25825408', 'av26571119', 'av17780457', 'av14784133', 'av26907397', 'av34857939', 'av28736124', 'av31271089', 'av20136653', 'av5077503', 'av31850305', 'av28288072', 'av20390957', 'av30165018', 'av19223279', 'av31148551', 'av17156466', 'av31873948', 'av29475489', 'av33271002', 'av20821251', 'av13955229', 'av29941148', 'av24686945', 'av18898418', 'av20926615', 'av30916759', 'av30891629', 'av27889386', 'av15243642', 'av21075762', 'av28184822', 'av17380619', 'av10403952', 'av23595655', 'av28245699', 'av21971692', 'av28324064', 'av19214174', 'av26320718', 'av18175621', 'av34552781', 'av29500126', 'av26069452', 'av25019273', 'av16746568', 'av26493634', 'av18102826', 'av31077887', 'av28440983', 'av34852126', 'av24418277', 'av21402989', 'av12591706', 'av17084083', 'av3203756', 'av35395171', 'av23430528', 'av3811768', 'av29236478', 'av11051229', 'av23687259', 'av28936019', 'av21911108', 'av25530329', 'av19850595', 'av11866707', 'av28984626', 'av23907250', 'av18002414', 'av29527268', 'av7039576', 'av24549950', 'av20483559', 'av14360897', 'av22913303', 'av28124912', 'av20677570', 'av16805456', 'av33370218', 'av16074566', 'av32037987', 'av16598595', 'av22886652', 'av7674773', 'av17772691', 'av16835900', 'av22819244', 'av17415123', 'av23159147', 'av15259658', 'av14472579', 'av28988287', 'av26026158', 'av18111939', 'av13418228', 'av25857227', 'av14837336', 'av15206447', 'av31876155', 'av29659182', 'av24290618', 'av20477224', 'av9583778', 'av33166885', 'av32084602', 'av16465360', 'av11243852', 'av35385840', 'av27873708', 'av19236098', 'av12806834', 'av23801999', 'av20230561', 'av8248013', 'av22511456', 'av12861461', 'av7264661', 'av27147121', 'av25441727', 'av21107594', 'av23114071', 'av12783412', 'av8942863', 'av34427579', 'av32671102', 'av28340679', 'av17735608', 'av31207479', 'av22082151', 'av21434265', 'av19359365', 'av14130074', 'av33244344', 'av26209419', 'av23630895', 'av21329209', 'av18897496', 'av17009789', 'av15970113', 'av23956608', 'av17956909', 'av31317641', 'av17744190', 'av33444350', 'av25678641', 'av17871423', 'av20126767', 'av32812969', 'av20923718', 'av20833694', 'av13775453', 'av28165246', 'av12558575', 'av10266900', 'av32673807', 'av19253176', 'av16633778', 'av16169372', 'av12362404', 'av10695340', 'av32768008', 'av25088338', 'av18801175', 'av31773533', 'av31325213', 'av13073819', 'av10463308', 'av2915458', 'av31980623', 'av22122864', 'av17738302', 'av17354942', 'av24739150', 'av19010059', 'av14861304', 'av14030598', 'av31265059', 'av17977626', 'av29492573', 'av26139474', 'av12515734', 'av7043136', 'av716890', 'av31764852', 'av30375043', 'av26683770', 'av24438276', 'av23721065', 'av17605028', 'av12363996', 'av20186931', 'av6712624', 'av3018878', 'av658778', 'av26029061', 'av19254310', 'av17933185', 'av9792904', 'av3630288', 'av26542205', 'av23825358', 'av20935805', 'av18045728', 'av6037424', 'av23068093', 'av18673232', 'av27256874', 'av22579907', 'av20437755', 'av15576288', 'av26485686', 'av19252466', 'av18300197', 'av12562006', 'av14409765', 'av10507415', 'av28876495', 'av15540094', 'av14213732', 'av11072314', 'av12953668', 'av3803751', 'av20706709', 'av15406717', 'av30246249', 'av24500315', 'av15991110', 'av10298385', 'av6027735', 'av32505164', 'av31707432', 'av24231508', 'av23354924', 'av13977529', 'av12372348', 'av11300024', 'av4438418', 'av29694011', 'av20238606', 'av33341306', 'av30325737', 'av21724344', 'av21621238', 'av34621190', 'av31240571', 'av29813790', 'av21650839', 'av16718767', 'av14871545', 'av14131050', 'av12128685', 'av31011601', 'av25146237', 'av24532838', 'av23228891', 'av22001499', 'av17527239', 'av16605094', 'av12139497', 'av34717186', 'av25316448', 'av18224862', 'av18088392', 'av11107428', 'av9423531', 'av32534070', 'av31378444', 'av30987957', 'av28961937', 'av14800639', 'av35367506', 'av34928557', 'av27849107', 'av19954369', 'av19116051', 'av8576504', 'av3236803', 'av35298582', 'av30188788', 'av23769167', 'av17441931', 'av11909491', 'av26549395', 'av22269686', 'av12807259', 'av10468280', 'av34955995', 'av31673482', 'av30929238', 'av30161150', 'av28227830', 'av28110781', 'av26529162', 'av22937512', 'av22000806', 'av20534033', 'av34886081', 'av34400476', 'av23289122', 'av23239292', 'av11127999', 'av9858927', 'av8942447', 'av30336121', 'av27223098', 'av24651147', 'av24231848', 'av23162726', 'av18130909', 'av15494856', 'av12990941', 'av11047285', 'av25330948', 'av19818575', 'av18233258', 'av18094760', 'av16263855', 'av15483447', 'av12879877', 'av9612368', 'av32155532', 'av31023535', 'av26098187', 'av23980400', 'av18740161', 'av11484644', 'av7801152', 'av2671505', 'av35079884', 'av25846468', 'av24347990', 'av20719135', 'av18216177', 'av16431915', 'av16403646', 'av15404634', 'av12469273', 'av35304032', 'av35050188', 'av34307811', 'av34081204', 'av33776590', 'av32506009', 'av20186234', 'av11228066', 'av6998143', 'av35336343', 'av33653427', 'av33527273', 'av33264769', 'av28004913', 'av24933958', 'av24012589', 'av20699188', 'av20229568', 'av10931411', 'av10787638', 'av10381686', 'av35312554', 'av34332876', 'av31216586', 'av30153934', 'av28209296', 'av21909984', 'av20257091', 'av16459784', 'av15420932', 'av12375760', 'av11206380', 'av6228165', 'av29111438', 'av25012255', 'av22001389', 'av21707600', 'av15820629', 'av13808250', 'av11821225', 'av11731332', 'av3802061', 'av3419438', 'av3236428', 'av35126534', 'av34502562', 'av34458389', 'av33976653', 'av31269011', 'av31030608', 'av23855188', 'av23580680', 'av23156040', 'av18067473', 'av11904215', 'av10966422', 'av6439022', 'av26475633', 'av21638088', 'av19953117', 'av19730356', 'av17360573', 'av15170208', 'av10655808', 'av8939932', 'av6932313', 'av32925846', 'av30379536', 'av22868499', 'av22631226', 'av18068630', 'av8425900', 'av2642087', 'av33900983', 'av33465987', 'av32549606', 'av31967420', 'av31922014', 'av31898203', 'av28544333', 'av28420651', 'av23853463', 'av20230040', 'av16810070', 'av16789462', 'av15003447', 'av7680885', 'av34888124', 'av27932272', 'av23783649', 'av23349433', 'av18754274', 'av18648019', 'av15700164', 'av14485967', 'av12846717', 'av11090415', 'av8577298', 'av33943180', 'av33921436', 'av26483895', 'av25765000', 'av24146007', 'av24028412', 'av23230577', 'av16223311', 'av13419702', 'av11329324', 'av11047208', 'av7017255', 'av6231522', 'av4401482', 'av4354377', 'av35188230', 'av35146457', 'av32089024', 'av31221467', 'av28985217', 'av28792857', 'av27876142', 'av17611057', 'av16597029', 'av12417439', 'av12366308', 'av11633254', 'av11530134', 'av11471285', 'av11100776', 'av9187471', 'av8374106', 'av6709836', 'av3819732', 'av33399229', 'av33330333', 'av32629632', 'av32289022', 'av32091874', 'av30906230', 'av29487928', 'av29028954', 'av28397119', 'av27898381', 'av24426183', 'av20413294', 'av20242013', 'av12995014', 'av12846427', 'av12003993', 'av11689201', 'av11544217', 'av11360710', 'av11269011', 'av7682324', 'av35223821', 'av34686067', 'av32193161', 'av31239800', 'av30658743', 'av30176277', 'av29905543', 'av25357240', 'av24154417', 'av23356899', 'av23160146', 'av23119786', 'av22876509', 'av21618029', 'av20210976', 'av17589201', 'av17139015', 'av15482873', 'av7039068', 'av5077661', 'av33471845', 'av33420678', 'av31683746', 'av30224878', 'av26899655', 'av23935189', 'av19353544', 'av16449249', 'av13025107', 'av12878417', 'av12850378', 'av12586843', 'av12100983', 'av11635404', 'av10601249', 'av9176365', 'av8471602', 'av3587440', 'av35298233', 'av34903549', 'av34830174', 'av34639120', 'av31401977', 'av31061013', 'av29834055', 'av29655811', 'av29228302', 'av28611849', 'av26829757', 'av24564749', 'av24499189', 'av23786396', 'av23204886', 'av21623152', 'av20876686', 'av20694106', 'av18484134', 'av13205847', 'av12829835', 'av10475974', 'av10459407', 'av10421109', 'av7405753', 'av6848662', 'av35082511', 'av34458951', 'av34099001', 'av33398206', 'av32292850', 'av31516610', 'av31003393', 'av29297667', 'av29179469', 'av29080844', 'av28229597', 'av26057247', 'av25240991', 'av24387283', 'av23920464', 'av22301683', 'av21611306', 'av21532246', 'av21071399', 'av18032775', 'av17828595', 'av17246366', 'av15619331', 'av13287959', 'av13096994', 'av11302892', 'av11102242', 'av10794435', 'av7373635', 'av6960251', 'av6714576', 'av4873551', 'av34943441', 'av34819578', 'av31379821', 'av30978012', 'av27675802', 'av27133704', 'av26915623', 'av25515592', 'av24969094', 'av19769165', 'av18985983', 'av18215017', 'av17253843', 'av15529330', 'av14038403', 'av13360755', 'av12389133', 'av12314445', 'av11980720', 'av11276447', 'av11219006', 'av10912195', 'av10877353', 'av10556935', 'av9481868', 'av9144638', 'av8773243', 'av8313082', 'av8158088', 'av6893788', 'av6023064', 'av195175', 'av35391100', 'av35073244', 'av32383328', 'av32103041', 'av31935423', 'av31015042', 'av28035651', 'av27954644', 'av27233114', 'av27225411', 'av27078561', 'av25780406', 'av25697107', 'av25137058', 'av24064311', 'av22927728', 'av21803052', 'av21638070', 'av21416848', 'av18291798', 'av18150560', 'av17394979', 'av16956585', 'av14733350', 'av13516159', 'av12830242', 'av12596835', 'av11159459', 'av35273282', 'av35051094', 'av34888316', 'av34875227', 'av34047410', 'av33741406', 'av31973179', 'av31622790', 'av31514201', 'av31283690', 'av31270430', 'av30438273', 'av30198392', 'av29515940', 'av28572042', 'av28137774', 'av28039189', 'av27889076', 'av27457684', 'av26894209', 'av26786119', 'av24425614', 'av24393634', 'av23782163', 'av23316608', 'av22616643', 'av21715345', 'av20852460', 'av20599652', 'av18378965', 'av17654735', 'av17281215', 'av15489083', 'av14481287', 'av14101188', 'av11129069', 'av11018598', 'av10638582', 'av10382273', 'av10264553', 'av9278464', 'av8979728', 'av4865956', 'av2433402', 'av35262985', 'av34945173', 'av34337125', 'av33517277', 'av32740371', 'av32028751', 'av31535467', 'av31210373', 'av29765655', 'av28908452', 'av28274605', 'av26779701', 'av26529227', 'av26057644', 'av25849702', 'av25690386', 'av25420500', 'av24891714', 'av24033438', 'av24021182', 'av22616542', 'av22182560', 'av20768125', 'av20716982', 'av19046891', 'av18358503', 'av18092528', 'av16961156', 'av16586818', 'av15483175', 'av11910334', 'av11840340', 'av11821941', 'av10841056', 'av10511362', 'av10081420', 'av8027140', 'av7994494', 'av7835317', 'av35168459', 'av35127982', 'av35126829', 'av35108261', 'av34529015', 'av34381212', 'av34036008', 'av32257552', 'av31599504', 'av31451931', 'av31018658', 'av30968992', 'av30226024', 'av29402272', 'av28990532', 'av28977441', 'av28959015', 'av28399549', 'av26420147', 'av24868606', 'av23919937', 'av22765717', 'av18909178', 'av18618793', 'av18253168', 'av18227914', 'av17955560', 'av17674529', 'av17540890'],'麦当劳': ['av2083631', 'av15297467', 'av9934915', 'av13659620', 'av19010887', 'av593031', 'av6407435', 'av22553569', 'av32808210', 'av29274349', 'av23198349', 'av15173575', 'av29662070', 'av15413934', 'av11896520', 'av9678118', 'av4637575', 'av33804360', 'av10039796', 'av551670', 'av35387398', 'av23928892', 'av23733883', 'av6589943', 'av6952009', 'av27821588', 'av35331761', 'av10854357', 'av31568830', 'av33610913', 'av19207762', 'av32842290', 'av24993775', 'av3512974', 'av1133239', 'av20325892', 'av24574541', 'av28477589', 'av10122955', 'av27274521', 'av6656900', 'av1242423', 'av33982327', 'av31143056', 'av29254802', 'av24960787', 'av13195722', 'av27838570', 'av31518539', 'av24098081', 'av15847943', 'av32535225', 'av15273597', 'av28916082', 'av15738172', 'av26796427', 'av13813271', 'av27242317', 'av34762780', 'av34545636', 'av22423890', 'av33434970', 'av11689175', 'av26830232', 'av3441051', 'av15260955', 'av27866139', 'av18107196', 'av12523449', 'av25575410', 'av30834447', 'av35187324', 'av6464492', 'av20972031', 'av35357148', 'av4637592', 'av6655300', 'av11788940', 'av9632712', 'av10668752', 'av4631030', 'av18196938', 'av18924200', 'av35114934', 'av23389938', 'av25864679', 'av10285910', 'av23928119', 'av15256049', 'av34553045', 'av34035098', 'av34949287', 'av26995610', 'av25207172', 'av254026', 'av29469016', 'av12402952', 'av23928404', 'av20056192', 'av5106513', 'av23399841', 'av24278462', 'av21520001', 'av35098304', 'av23913453', 'av23804628', 'av33867845', 'av2350850', 'av24817994', 'av2897180', 'av28115171', 'av3921259', 'av24779832', 'av30365485', 'av15731036', 'av31497921', 'av25795138', 'av6654790', 'av23780519', 'av8133842', 'av25851622', 'av34996502', 'av26049372', 'av34689221', 'av5770709', 'av15243642', 'av20684615', 'av33116646', 'av24570403', 'av2429402', 'av35073246', 'av17467513', 'av24732062', 'av31989142', 'av30121199', 'av15073676', 'av32760334', 'av32460091', 'av21413089', 'av15184386', 'av24414685', 'av33306415', 'av35101577', 'av34684512', 'av35369509', 'av35246632', 'av32269266', 'av28710976', 'av34451428', 'av34973696', 'av34977285', 'av29772082', 'av27137602', 'av33356066', 'av34764674', 'av35154686', 'av28653089', 'av24295502', 'av35091322', 'av31658888', 'av34907656', 'av32219020', 'av35237271', 'av33934694', 'av35294879', 'av5614671', 'av35130005', 'av35217196', 'av26578059', 'av30466461', 'av17664632', 'av27025494', 'av29410748', 'av34550683', 'av34389480', 'av34925142', 'av12904895', 'av29194394', 'av34147855', 'av24308792', 'av17441931', 'av15768229', 'av7112113', 'av35206946', 'av18126063', 'av33941709', 'av23773745', 'av35205634', 'av22548152', 'av33948337', 'av21270479', 'av35205935', 'av31277548', 'av21663640', 'av14594206', 'av22248894', 'av23930620', 'av22651064', 'av19227565', 'av34852522', 'av28520058', 'av20286786', 'av10845194', 'av15767020', 'av23559143', 'av20821251', 'av15938946', 'av33360313', 'av28190669', 'av24700167', 'av18639643', 'av35370975', 'av28865641', 'av28659788', 'av28608608', 'av10403952', 'av26680244', 'av27218296', 'av25948194', 'av18201686', 'av29500126', 'av34757306', 'av34802959', 'av23157835', 'av12530722', 'av26182109', 'av35350800', 'av34969567', 'av35395171', 'av21869163', 'av15841414', 'av21789397', 'av11983357', 'av32095657', 'av13911754', 'av32196541', 'av32590973', 'av11866707', 'av27518020', 'av26954513', 'av10417755', 'av35360990', 'av12795754', 'av30342483', 'av26689360', 'av18865247', 'av33022925', 'av21397631', 'av34757552', 'av26752624', 'av11709943', 'av31029776', 'av7877749', 'av10872390', 'av34049976', 'av16290457', 'av13769484', 'av13183744', 'av4961448', 'av23932611', 'av21555509', 'av20901606', 'av22379655', 'av35119347', 'av11149444', 'av34907628', 'av32051498', 'av19621376', 'av31286316', 'av13446259', 'av29421781', 'av16465360', 'av14341703', 'av5594251', 'av19236098', 'av31075830', 'av29833038', 'av17769218', 'av15069268', 'av14582776', 'av34903364', 'av27696349', 'av22424510', 'av2127867', 'av31925635', 'av13619014', 'av34780995', 'av34155211', 'av33244344', 'av10416467', 'av18756407', 'av15746134', 'av10790403', 'av25067071', 'av23360054', 'av22295242', 'av21079091', 'av15272289', 'av22562089', 'av22442658', 'av14732653', 'av10921216', 'av32920592', 'av21693052', 'av19098324', 'av29182694', 'av10266900', 'av18377252', 'av13122998', 'av12475931', 'av8787110', 'av28567049', 'av17451381', 'av26793583', 'av24326215', 'av12754898', 'av18210474', 'av2217696', 'av34912732', 'av3213316', 'av18841873', 'av8673952', 'av7969356', 'av24024745', 'av19784738', 'av12492919', 'av10827211', 'av34034984', 'av33460459', 'av32119333', 'av14581880', 'av12105738', 'av6398837', 'av3059584', 'av29643900', 'av24859328', 'av23599603', 'av22570309', 'av16779948', 'av14241208', 'av401272', 'av34566379', 'av31672956', 'av18755546', 'av15755522', 'av7745476', 'av20186947', 'av35265573', 'av32260094', 'av18795373', 'av12673816', 'av11183320', 'av9093559', 'av5304731', 'av32240392', 'av22579907', 'av18200511', 'av6728046', 'av3587397', 'av32882657', 'av27775634', 'av12461838', 'av9286126', 'av5766944', 'av34990876', 'av18336244', 'av16838983', 'av12755920', 'av3279909', 'av22183073', 'av20259564', 'av14213732', 'av12119021', 'av8896408', 'av19549835', 'av17199227', 'av14272199', 'av12680757', 'av35247993', 'av19733819', 'av17687726', 'av11939038', 'av10474968', 'av7948130', 'av22528476', 'av15071423', 'av11404232', 'av11052957', 'av10898855', 'av24231508', 'av14267672', 'av3788800', 'av30910881', 'av24595159', 'av22793197', 'av28228826', 'av20223302', 'av17517915', 'av13279625', 'av32918707', 'av26053673', 'av21724344', 'av17064198', 'av24593591', 'av23054126', 'av15534505', 'av12344947', 'av11795372', 'av10192492', 'av8562550', 'av34877471', 'av18795639', 'av16312897', 'av14924362', 'av33654111', 'av27126852', 'av19120000', 'av12156015', 'av6067509', 'av2992606', 'av2992388', 'av34717186', 'av29782292', 'av25923384', 'av24374617', 'av23362714', 'av22835797', 'av20609972', 'av13793172', 'av13145674', 'av10626881', 'av9033689', 'av26050546', 'av23945484', 'av18413366', 'av15739333', 'av12255680', 'av11056034', 'av7018117', 'av22361374', 'av9340726', 'av7570128', 'av5043160', 'av4125492', 'av2820066', 'av35248494', 'av35100982', 'av29815718', 'av23769167', 'av23746297', 'av22116937', 'av12200091', 'av11832719', 'av6529703', 'av23871428', 'av22257514', 'av20023577', 'av14982993', 'av11817927', 'av11380819', 'av8748993', 'av3273857', 'av2765091', 'av35252719', 'av32961906', 'av22607250', 'av14847118', 'av13115195', 'av12297242', 'av8288295', 'av31821295', 'av31342028', 'av26258063', 'av21567132', 'av9219084', 'av6471903', 'av3586495', 'av3164152', 'av35359001', 'av35009550', 'av31157235', 'av27193217', 'av25264944', 'av23275448', 'av22601947', 'av18202280', 'av17015821', 'av14761923', 'av10693873', 'av8429983', 'av7316147', 'av4243214', 'av3064604', 'av35233814', 'av22523097', 'av18200655', 'av18102073', 'av16046537', 'av15458846', 'av12315820', 'av7015169', 'av20083304', 'av19614488', 'av17449381', 'av6411614', 'av3028898', 'av31474692', 'av24190310', 'av21340392', 'av19770011', 'av18930269', 'av16890068', 'av15404634', 'av12293699', 'av11588684', 'av7222918', 'av34467185', 'av25207736', 'av17770431', 'av17264783', 'av15346715', 'av10822611', 'av2700503', 'av35265868', 'av34834682', 'av33925152', 'av23347047', 'av22924404', 'av22519381', 'av21035270', 'av20050206', 'av15751334', 'av11984251', 'av10628804', 'av4493084', 'av3396256', 'av3279313', 'av33891325', 'av29957566', 'av29825700', 'av18694094', 'av17202071', 'av16539568', 'av15753782', 'av9873760', 'av35128459', 'av33322251', 'av31756494', 'av28037739', 'av24108823', 'av23950459', 'av21558004', 'av14275967', 'av13112608', 'av10556325', 'av9983120', 'av9284947', 'av9060671', 'av6436973', 'av34840506', 'av33468406', 'av26882381', 'av16935192', 'av16829184', 'av16777038', 'av16589756', 'av15749670', 'av11598339', 'av10966422', 'av7943763', 'av2873721', 'av744430', 'av35281356', 'av31221163', 'av30921324', 'av30347044', 'av23590534', 'av21070519', 'av19080151', 'av16783960', 'av14664939', 'av14036704', 'av13159667', 'av12442470', 'av11965592', 'av11218284', 'av10916137', 'av8670928', 'av5614559', 'av3364795', 'av337836', 'av35343191', 'av34135696', 'av31049231', 'av31047032', 'av26317808', 'av24891728', 'av24727245', 'av20837228', 'av20727313', 'av19860154', 'av16783627', 'av13364587', 'av12498780', 'av10923788', 'av10881521', 'av10542075', 'av9857415', 'av7225465', 'av5386678', 'av4056610', 'av33459766', 'av31922014', 'av29078463', 'av27804969', 'av24460830', 'av22269119', 'av20598525', 'av19780662', 'av15936113', 'av14819993', 'av11077576', 'av10630813', 'av10280531', 'av9673856', 'av6064017', 'av690782', 'av32156903', 'av31681963', 'av31681481', 'av31437480', 'av31248878', 'av20959198', 'av16936085', 'av10983094', 'av5989506', 'av5778700', 'av1791916', 'av27460564', 'av23725887', 'av23363056', 'av16223311', 'av11178742', 'av10143868', 'av9757798', 'av8033273', 'av4354377', 'av2874915', 'av31644441', 'av31221467', 'av30881780', 'av30133848', 'av24820992', 'av23437346', 'av18683073', 'av14672134', 'av14381468', 'av11147895', 'av9349437', 'av8374106', 'av5115039', 'av3279225', 'av508220', 'av34947280', 'av32835946', 'av32577488', 'av29929547', 'av29861080', 'av28397341', 'av20891356', 'av17196280', 'av15304018', 'av14486389', 'av13920128', 'av13793779', 'av11882146', 'av10642781', 'av7687334', 'av6729194', 'av35238978', 'av34922442', 'av34792192', 'av34129150', 'av32670120', 'av31068145', 'av29597168', 'av23936155', 'av23656572', 'av15913951', 'av15536052', 'av12487982', 'av12292025', 'av9042387', 'av7083283', 'av3371492', 'av33711479', 'av33560209', 'av33447339', 'av32290898', 'av32011306', 'av23599436', 'av22349053', 'av15714225', 'av14244640', 'av13950644', 'av13568878', 'av12084952', 'av12077383', 'av11826818', 'av11623775', 'av8891207', 'av6933088', 'av6678659', 'av6398932', 'av35303675', 'av34830174', 'av33971882', 'av33595721', 'av32983447', 'av31695055', 'av29205676', 'av28611849', 'av28470690', 'av28332634', 'av27864909', 'av27716876', 'av26299494', 'av26205352', 'av24978803', 'av24499189', 'av23829407', 'av23786396', 'av23472986', 'av22841722', 'av22519126', 'av18600566', 'av18379892', 'av17149919', 'av15980832', 'av15896412', 'av15235531', 'av14558591', 'av12316243', 'av11631285', 'av9479009', 'av7156525', 'av3390760', 'av35241245', 'av32661640', 'av32263619', 'av31760395', 'av28710282', 'av27229499', 'av27138787', 'av26239853', 'av26050363', 'av24979087', 'av23963286', 'av23713891', 'av22359128', 'av21579387', 'av21377004', 'av21343242', 'av21071399', 'av18419092', 'av16937402', 'av16357860', 'av15004457', 'av14833168', 'av14268821', 'av13994909', 'av12641503', 'av12292702', 'av12288712', 'av12026264', 'av11867605', 'av11849497', 'av11732379', 'av10835666', 'av10589952', 'av9745034', 'av9458457', 'av8762709', 'av6960251', 'av5091656', 'av4301583', 'av3523000', 'av3158487', 'av3008525', 'av35146487', 'av34943441', 'av34022743', 'av33541094', 'av30020411', 'av29577259', 'av27675802', 'av24663269', 'av24539452', 'av24004712', 'av23890061', 'av23740692', 'av23631613', 'av22523839', 'av21998254', 'av18681211', 'av17944370', 'av15762435', 'av14762309', 'av14718668', 'av14361153', 'av14033282', 'av13364473', 'av13187768', 'av12389133', 'av11947725', 'av11735913', 'av11727625', 'av11292922', 'av10225556', 'av9877756', 'av8866952', 'av8671050', 'av8669477', 'av8221785', 'av4115295', 'av1915376', 'av34795921', 'av33484628', 'av31426643', 'av31165227', 'av29252136', 'av29130544', 'av28523724', 'av27127808', 'av26678062', 'av23948945', 'av22577821', 'av21903336', 'av21336912', 'av19589738', 'av18762316', 'av18739626', 'av17150037', 'av16350897', 'av15896754', 'av14967644', 'av14879258', 'av14600729', 'av14158320', 'av13358780', 'av13115618', 'av12732607', 'av12668361', 'av12471033', 'av12155157', 'av11104435', 'av10253952', 'av9400575', 'av9058853', 'av7656800', 'av7222843', 'av6974038', 'av4115328', 'av3932711', 'av3315529', 'av1504885', 'av1163311', 'av34216638', 'av33264872', 'av33229952', 'av32359929', 'av32317850', 'av31776591', 'av31735823', 'av29256897', 'av26786119', 'av26734927', 'av26264815', 'av26223562', 'av25381252', 'av24809427', 'av23836675', 'av23557700', 'av22238294', 'av22171371', 'av20274888', 'av19781280', 'av17450234', 'av15768943', 'av15695421', 'av13516257', 'av11784826', 'av11168803', 'av10625297', 'av10440922', 'av10382273', 'av10264553', 'av10122835', 'av9174685', 'av9044267', 'av8761795', 'av7944538', 'av7268606', 'av6765254', 'av4727940', 'av3028454', 'av1777574', 'av35116330', 'av33509628', 'av33493180', 'av33007562', 'av32783894', 'av32215693', 'av32172821', 'av30246247', 'av30226100', 'av30032078', 'av29020823', 'av28684921', 'av26779701', 'av25816719', 'av24891714', 'av24293107', 'av23050843', 'av22666668', 'av22182560', 'av21332529', 'av20173420', 'av19410407', 'av19046891', 'av18205530', 'av17635831', 'av16154923', 'av15799804', 'av15433382', 'av14804626', 'av14662228', 'av14234556', 'av12375889', 'av8493030', 'av8375825', 'av8000615', 'av7515315', 'av5359231', 'av3158061', 'av35124914', 'av34931890', 'av33406436', 'av32632225', 'av32294721', 'av32283268', 'av31813033', 'av31562666', 'av31422050', 'av31067132', 'av30731285', 'av28069223', 'av27859196', 'av27394584', 'av27259500', 'av27052323', 'av26263230', 'av24494425', 'av24051424', 'av23922145', 'av23919937', 'av23778307', 'av23631575', 'av22286069', 'av22051776', 'av20580673', 'av20518932', 'av19832260', 'av18664293', 'av18524914', 'av18419161', 'av17391368', 'av16291211', 'av14991168', 'av14789438', 'av13994165', 'av13895746', 'av12603136', 'av11936427', 'av11807498', 'av11588064', 'av11511325', 'av11434470', 'av11298672', 'av10525758', 'av10504183', 'av9718036', 'av9602804', 'av9386015', 'av9381477', 'av9329739', 'av8890153', 'av8579037', 'av8554357', 'av8309967'], '德克士': ['av34018514', 'av30776178', 'av29055056', 'av18521308', 'av19242249', 'av33758787', 'av30977072', 'av35398681', 'av34949845', 'av13484022', 'av33174560', 'av11716375', 'av10666020', 'av24903149', 'av18228043', 'av33206484', 'av30764272', 'av16333279', 'av16719528', 'av22611332', 'av27899931', 'av30128234', 'av31635657', 'av12497124', 'av23862973', 'av28351686', 'av34345289', 'av14690113', 'av12403086', 'av8897751', 'av17255496', 'av12043822', 'av16162136', 'av33548626', 'av12657897', 'av22853040', 'av13485324', 'av5034828', 'av29418235', 'av11531959', 'av31072482', 'av30846831', 'av30689109', 'av11739200', 'av25179373', 'av34332362', 'av32782624', 'av31742232', 'av30171994', 'av24449933', 'av8747026', 'av22431730', 'av34617543', 'av11165530', 'av35309586', 'av21853155', 'av12578478', 'av34333803', 'av32213418', 'av30493048', 'av16301861', 'av23564647', 'av33317965', 'av12606862', 'av24204402', 'av23919680', 'av32058265', 'av18196938', 'av16656521', 'av16943212', 'av26497870', 'av17920753', 'av13683996', 'av17416834', 'av13482976', 'av4821577', 'av34820849', 'av31753201', 'av18329183', 'av29733019', 'av2234894', 'av27005923', 'av12963148', 'av26076208', 'av16984952', 'av12206140', 'av19205426', 'av12199005', 'av27466573', 'av3235612', 'av15578241', 'av35105743', 'av30130620', 'av11213656', 'av29374533', 'av32168182', 'av19319700', 'av18014624', 'av32524777', 'av33666450', 'av24184833', 'av15842589', 'av13807197', 'av18212429', 'av21455996', 'av26037502', 'av16442292', 'av18558505', 'av19149574', 'av16390035', 'av4175145', 'av29511203', 'av24888357', 'av17441931', 'av12063262', 'av31689763', 'av16744222', 'av21277220', 'av14108849', 'av27161275', 'av33241801', 'av30950886', 'av13292229', 'av24602023', 'av12199613', 'av29866223', 'av34300211', 'av23750346', 'av20635772', 'av23978502', 'av11893972', 'av5352107', 'av27418207', 'av30967939', 'av21796352', 'av23657718', 'av12992686', 'av26501536', 'av23514732', 'av24717738', 'av7902745', 'av18227914', 'av17540291', 'av18861386', 'av16889418', 'av21540661', 'av9380753', 'av12368318', 'av24182686', 'av4464471', 'av32040920', 'av12259264', 'av13165007', 'av27073405', 'av4265198', 'av12992552', 'av26268653', 'av34778177', 'av11181178', 'av25790107', 'av25680343', 'av13325998', 'av4793056', 'av32957934', 'av12257401', 'av34334237', 'av33542831', 'av33093209', 'av32747371', 'av30972061', 'av30889088', 'av30680710', 'av29958220', 'av29760488', 'av29056589', 'av28934380', 'av28050270', 'av27599118', 'av27076388', 'av26462452', 'av25765723', 'av25527183', 'av24533321', 'av24270506', 'av23900677', 'av21858360', 'av21038154', 'av20993391', 'av19627487', 'av19192143', 'av16424294', 'av15213231', 'av13769186', 'av13288493', 'av11748644', 'av11681901', 'av11288335', 'av11082129', 'av9076043', 'av29403485', 'av3424729', 'av22913303', 'av15002013', 'av31826226', 'av20149299', 'av20141247', 'av15962422', 'av26589531', 'av29266187', 'av35298593', 'av5399600', 'av31738752', 'av25708970', 'av31271756', 'av8856598', 'av6540225', 'av14764209', 'av31023535', 'av33976653', 'av25932606', 'av32526910', 'av13357264', 'av32111599', 'av31400637', 'av26559737', 'av31766629', 'av27926463', 'av27339672', 'av23000166', 'av13014050', 'av8856645', 'av6286981', 'av4946785', 'av25385802', 'av17404247', 'av29401633', 'av35214613', 'av35191851', 'av7341914', 'av12791236', 'av13006470', 'av27600398', 'av27962901', 'av26190283', 'av29862124', 'av9998585', 'av23613340', 'av29820190', 'av14680152', 'av18624110', 'av12282613', 'av8655440', 'av17919915', 'av21544031', 'av3841267', 'av17790223', 'av19030369', 'av34814818', 'av20495868', 'av34492456', 'av2852534', 'av16999807', 'av32767059', 'av7301722', 'av26019708', 'av31087875', 'av27886381', 'av27741483', 'av26037874', 'av24854841', 'av20394437', 'av18860968', 'av15280344', 'av14162583', 'av12258720', 'av10767330', 'av9001756', 'av5602941']}
    for k in key:
        n=0
        id_lists=result[k]
        for id in id_lists:
            print(id)
            time.sleep(2)
            url = 'https://api.bilibili.com/x/v2/reply?callback=jQuery17207334597019735183_1540982500519&jsonp=jsonp&pn=1&type=1&oid=' + id[2:] + '&sort=0&_=' + str(
                int(time.time() * 1000))
            headers = {
                'Cookie': 'LIVE_BUVID=AUTO6915375856445563; stardustvideo=1; buvid3=EEB30FF5-70B4-4E16-B15A-94FE3F7AF07F163007infoc; rpdid=kmpsximoqmdoskmsqsxqw; finger=edc6ecda; CURRENT_FNVAL=16; sid=4ih3nm1u; fts=1540866975; UM_distinctid=166c2db295180-082aa06c2afa6d-47e1039-100200-166c2db2952110',
                'Host': 'api.bilibili.com',
                'Referer': 'https://www.bilibili.com/video/' + id,
                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'
            }
            df = pandas.DataFrame()
            html = requests.get(url, headers=headers).text
            html = (html.split('(', 1))[1][:-1]
            html = json.loads(html)
            try:
                n=n+int(html['data']['page']['count'])
                pages = int(int(html['data']['page']['count']) / 20) + 1
                print(pages)
            except Exception as e:
                print(e)
                continue
            for page in range(1, pages+1):
                print('开始抓取第%d页' % page)
                url = 'https://api.bilibili.com/x/v2/reply?callback=jQuery17207334597019735183_1540982500519&jsonp=jsonp&pn='+str(page)+'&type=1&oid=' + id[2:] + '&sort=0&_=' + str(
                    int(time.time() * 1000))
                try:
                    get_comment(url, k, headers)
                except Exception as e:
                    print('重新抓取第%d页' % page)
                    get_comment(url, k, headers)
                    time.sleep(15)
        print(n)
        time.sleep(30)
